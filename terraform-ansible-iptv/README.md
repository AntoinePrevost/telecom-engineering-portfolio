# Cloud-Based IPTV Streaming Infrastructure

**Author:** Antoine Prevost | **Course:** GIN-208 - Network Virtualization and Automation

## ğŸ“‹ Table of Contents

- [Overview](#overview)
- [Architecture](#ï¸-architecture)
- [Quick Start](#-quick-start)
- [Project Structure](#-project-structure)
- [Configuration](#-configuration)
- **[ğŸ“– Architecture Documentation](docs/ARCHITECTURE.md)**
- **[ğŸš€ Deployment Guide](docs/DEPLOYMENT.md)**
- **[ğŸ”§ Troubleshooting Guide](docs/TROUBLESHOOTING.md)**

## Overview

This project demonstrates a complete DevOps automation pipeline for deploying a scalable IPTV live streaming service on AWS. It showcases enterprise-level network virtualization, infrastructure automation, and security best practices using Infrastructure as Code (IaC) principles.

## ğŸ¯ Learning Objectives

This project addresses the GIN-208 course objectives by implementing:

- **Cloud Automation**: Automated deployment using Terraform and Ansible
- **DevOps Practices**: Infrastructure as Code, configuration management, and automated provisioning
- **Network Virtualization**: Multi-tier network architecture with security isolation
- **IPTV Streaming**: Live video streaming using RTMP protocol and Nginx
- **Security Best Practices**: Bastion host, private subnets, security groups, and SSL/TLS encryption

## ğŸ—ï¸ Architecture

### Infrastructure Components

- **Bastion Host**: Secure jump server with multi-interface configuration
- **Load Balancer**: Nginx reverse proxy with SSL termination and Let's Encrypt certificates
- **Frontend Servers**: Nginx RTMP servers for video streaming
- **Backend Servers**: FFmpeg video processing and streaming sources
- **Network Segmentation**: Public/private subnets with controlled routing

### Technology Stack

- **Infrastructure Provisioning**: Terraform
- **Configuration Management**: Ansible
- **Cloud Provider**: AWS (EC2, VPC, Route 53, Elastic IPs)
- **Streaming Protocol**: RTMP (Real-Time Messaging Protocol)
- **Web Server**: Nginx with RTMP module
- **Video Processing**: FFmpeg
- **SSL/TLS**: Let's Encrypt certificates

## ğŸ“‹ Prerequisites

- AWS CLI configured with appropriate credentials
- Terraform >= 1.0
- Ansible >= 2.9
- Valid domain name for SSL certificate generation
- AWS Route 53 hosted zone

## ğŸš€ Quick Start

### 1. Infrastructure Deployment

```bash
# Navigate to terraform directory
cd terraform

# Initialize Terraform
terraform init

# Create terraform.tfvars file with your configuration
cp terraform.tfvars.example terraform.tfvars
# Edit terraform.tfvars with your specific values

# Plan and apply infrastructure
terraform plan
terraform apply
```

### 2. Configuration Management

```bash
# Navigate to ansible directory
cd ../ansible/ansible-project

# Run the playbook (inventory is auto-generated by Terraform)
ansible-playbook -i inventory.ini playbook.yaml
```

## ğŸ“ Project Structure

```
â”œâ”€â”€ README.md                          # This file
â”œâ”€â”€ docs/                             # Additional documentation
â”œâ”€â”€ terraform/                        # Infrastructure as Code
â”‚   â”œâ”€â”€ main.tf                      # AWS provider configuration
â”‚   â”œâ”€â”€ network.tf                   # VPC, subnets, routing
â”‚   â”œâ”€â”€ security.tf                  # Security groups and rules
â”‚   â”œâ”€â”€ bastion.tf                   # Bastion host configuration
â”‚   â”œâ”€â”€ loadbalancer.tf              # Load balancer instance
â”‚   â”œâ”€â”€ front.tf                     # Frontend server instances
â”‚   â”œâ”€â”€ back.tf                      # Backend server instances
â”‚   â”œâ”€â”€ keys.tf                      # SSH key management
â”‚   â”œâ”€â”€ variables.tf                 # Input variables
â”‚   â””â”€â”€ *_config_file.tf             # Dynamic configuration files
â””â”€â”€ ansible/
    â””â”€â”€ ansible-project/
        â”œâ”€â”€ playbook.yaml            # Main Ansible playbook
        â”œâ”€â”€ inventory.ini            # Auto-generated inventory
        â””â”€â”€ roles/                   # Ansible roles
            â”œâ”€â”€ bastion/             # Bastion configuration
            â”œâ”€â”€ loadbalancer/        # Load balancer setup
            â”œâ”€â”€ server-front/        # Frontend server config
            â””â”€â”€ server-back/         # Backend server config
```

## ï¿½ Configuration

### Terraform Variables

Key variables to configure in `terraform.tfvars`:

```hcl
# Network Configuration
vpc_name = "your-vpc-name"
public_cidr = "10.0.0.0/18"
private_1_cidr = "10.0.128.0/18"
private_2_cidr = "10.0.192.0/18"

# Domain Configuration
zone_dns = "your-domain.com"
site_name = "streaming"

# Instance Configuration
nombre_instance_front = 2
nombre_instance_back = 1
instance_type_front = "t3.micro"
instance_type_back = "t3.small"
```

### Network Architecture

- **Public Subnet** (10.0.0.0/18): Load balancer and bastion host
- **Private Subnet 1** (10.0.128.0/18): Frontend streaming servers
- **Private Subnet 2** (10.0.192.0/18): Backend processing servers

## ğŸ” Security Features

- **Network Segmentation**: Multi-tier architecture with isolated subnets
- **Bastion Host**: Secure access gateway with IP forwarding
- **Security Groups**: Restrictive firewall rules per service tier
- **SSL/TLS Encryption**: Automatic Let's Encrypt certificate provisioning
- **Private Key Management**: Automated SSH key generation and distribution
- **NAT Gateway**: Secure internet access for private instances

## ğŸ¥ Streaming Workflow

1. **Video Source**: Backend servers process and encode video using FFmpeg
2. **RTMP Streaming**: Video streams are sent via RTMP protocol to frontend servers
3. **Load Balancing**: Nginx load balancer distributes client connections
4. **SSL Termination**: HTTPS encryption handled at the load balancer
5. **Content Delivery**: Clients access streams through the load balancer

## ğŸ“Š Monitoring and Logs

- Nginx access and error logs on all web servers
- FFmpeg streaming logs on backend servers
- System logs accessible via SSH through bastion host

## ğŸ› ï¸ Troubleshooting

### Common Issues

1. **Certificate Generation Fails**
   - Verify DNS propagation for your domain
   - Check Route 53 hosted zone configuration

2. **Streaming Not Working**
   - Verify security group rules allow RTMP (port 1935)
   - Check FFmpeg processes on backend servers
   - Validate Nginx RTMP module configuration

3. **SSH Connection Issues**
   - Ensure bastion host is accessible
   - Verify SSH key permissions (0400)
   - Check security group SSH rules

## ğŸ¤ Contributing

This project follows infrastructure and configuration management best practices:

- Use descriptive resource names and tags
- Implement proper error handling in Ansible tasks
- Follow security principle of least privilege
- Document any configuration changes

## ğŸ“š Additional Resources

- [Terraform AWS Provider Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)
- [Ansible Documentation](https://docs.ansible.com/)
- [Nginx RTMP Module](https://github.com/arut/nginx-rtmp-module)
- [FFmpeg Documentation](https://ffmpeg.org/documentation.html)

## ï¿½â€ğŸ’» Author

**Antoine Prevost**  
GIN-208 - Network Virtualization and Automation Course Project

## ï¿½ğŸ“„ License

This project is part of the GIN-208 academic course on Network Virtualization and Automation.
